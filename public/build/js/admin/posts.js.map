{"version":3,"sources":["posts.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"posts.js","sourcesContent":["const _ELEMENTS = {\n\tinput_tags_slug: jQuery('#posts-input-tag-slug'),\n\tinput_tags_name: jQuery('#posts-input-tag-name'),\n\n\tdiv_tags_container:  jQuery('#posts-div-tags-container'),\n\tdiv_files_container: jQuery('#posts-div-files-container'),\n\n\tbutton_save_post:  jQuery('#posts-button-save'),\n\tbutton_create_tag: jQuery('#posts-button-tags-create'),\n\n\tbutton_fake_file_browse: jQuery('#fake-file-button-browse'),\n\tinput_fake_file_upload:  jQuery('#files-input-upload'),\n\tinput_fake_file_name:    jQuery('#fake-file-input-name'),\n\tbutton_fake_file_upload: jQuery('#fake-file-button-upload')\n}\n\njQuery(document).ready(function() {\n\t_ELEMENTS.input_fake_file_upload.change(function() {\n\t\t_ELEMENTS.input_fake_file_name.val(this.value)\n\n\t\t_ELEMENTS.button_fake_file_upload.prop('disabled', false)\n\t})\n\n\t_ELEMENTS.button_fake_file_browse.click(function() {\n\t\t_ELEMENTS.input_fake_file_upload.trigger('click')\n\t})\n\n\t// File upload\n\t_ELEMENTS.button_fake_file_upload.click(function() {\n\t\tvar form_data = new FormData()\n\t\t\tform_data.append('file', _ELEMENTS.input_fake_file_upload[0].files[0])\n\n\t\tjQuery.ajax({\n\t\t\turl   : this.getAttribute('data-route'),\n\t\t\tdata  : form_data,\n\t\t\ttype  : 'POST',\n\t\t\tcache : false,\n\t\t\tcontentType : false,\n\t\t\tprocessData : false,\n\t\t\tsuccess: function(response) {\n\t\t\t\tvar li_container = jQuery('<li/>').attr({\n\t\t\t\t\tclass: 'list-group-item',\n\t\t\t\t\t'data-file-id': response.id\n\t\t\t\t}).appendTo(_ELEMENTS.div_files_container)\n\n\t\t\t\tvar div_row = jQuery('<div/>').addClass('row').appendTo(li_container)\n\n\t\t\t\tjQuery('<div/>').addClass('col-xs-12 col-sm-8').text(response.name).appendTo(div_row)\n\n\t\t\t\tvar div_col = jQuery('<div/>').addClass('col-xs-12 col-sm-4 text-right').appendTo(div_row)\n\n\t\t\t\tvar div_btn_group = jQuery('<div/>').addClass('btn-group btn-group-sm').appendTo(div_col)\n\n\t\t\t\tjQuery('<a/>').attr({\n\t\t\t\t\thref: response.get_url,\n\t\t\t\t\tclass: 'btn btn-default',\n\t\t\t\t\ttarget: '_blank',\n\t\t\t\t}).append(jQuery('<i/>').addClass('fa fa-download')).appendTo(div_btn_group)\n\n\t\t\t\tjQuery('<button/>').attr({\n\t\t\t\t\tclass: 'btn btn-default',\n\t\t\t\t\t'data-role': 'delete-file',\n\t\t\t\t\t'data-route': response.del_url\n\t\t\t\t}).append(jQuery('<i/>').addClass('fa fa-trash')).appendTo(div_btn_group)\n\t\t\t}\n\t\t})\n\t})\n\n\t// File delete\n\t_ELEMENTS.div_files_container.on('click', '[data-role=\"delete-file\"]', function() {\n\t\tvar that = this\n\t\t\n\t\tjQuery.getJSON(this.getAttribute('data-route'), function() {\n\t\t\tjQuery(that).closest('.list-group-item').remove()\n\t\t})\n\t})\n\n\t// Tags\n\t_ELEMENTS.button_create_tag.click(function() {\n\t\tvar slug = _ELEMENTS.input_tags_slug.val()\n\t\tvar name = _ELEMENTS.input_tags_name.val()\n\n\t\tif (name.length) {\n\t\t\tvar container = jQuery('<span/>').attr({\n\t\t\t\tclass: 'label label-default tag',\n\t\t\t\t'data-name': name,\n\t\t\t\t'data-slug': slug\n\t\t\t}).text(name).appendTo(_ELEMENTS.div_tags_container).after(' ')\n\n\t\t\tjQuery('<span/>').attr('data-role', 'remove').appendTo(container).on('click', function() {\n\t\t\t\tthis.parentNode.parentNode.removeChild(this.parentNode)\n\t\t\t})\n\n\t\t\t_ELEMENTS.input_tags_slug.val(null)\n\t\t\t_ELEMENTS.input_tags_name.val(null)\n\t\t}\n\t})\n\n\t// Save post\n\t_ELEMENTS.button_save_post.click(function() {\n\t\t_ELEMENTS.button_save_post.button('loading')\n\n\t\tvar data = {}\n\n\t\tjQuery('.container').find('[name]').each(function() {\n\t\t\tdata[this.name] = this.value\n\t\t})\n\n\t\tdata['tags'] = _ELEMENTS.div_tags_container.find('span.tag').map(function() {\n\t\t\treturn {\n\t\t\t\tname: this.getAttribute('data-name'),\n\t\t\t\tslug: this.getAttribute('data-slug')\n\t\t\t}\n\t\t}).get()\n\n\t\tdata['files'] = _ELEMENTS.div_files_container.find('li[data-file-id]').map(function() {\n\t\t\treturn this.getAttribute('data-file-id')\n\t\t}).get()\n\n\t\tjQuery.post(this.getAttribute('data-route'), data, function(response) {\n\t\t\tif (response.redirect_to) {\n\t\t\t\twindow.location = response.redirect_to\n\t\t\t}\n\t\t}).complete(function() {\n\t\t\t_ELEMENTS.button_save_post.button('reset')\n\t\t})\n\t})\n})"],"sourceRoot":"/source/"}