{"version":3,"sources":["works.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"works.js","sourcesContent":["const _ELEMENTS = {\n\tbutton_fake_file_browse: jQuery('#fake-file-button-browse'),\n\tinput_fake_file_upload:  jQuery('#fake-file-input-upload'),\n\tinput_fake_file_name:    jQuery('#fake-file-input-name'),\n\n\tbutton_add_new_image: jQuery('#works-button-add-new-image'),\n\tbutton_save_work: jQuery('#works-button-save'),\n\n\ttextarea_image_description: jQuery('#works-textarea-image-description'),\n\n\ttable_images: jQuery('#works-table-images'),\n\n\tdiv_add_image_modal_container: jQuery('#works-div-modal-add-image-container')\n}\n\njQuery(document).ready(function() {\n\t_ELEMENTS.input_fake_file_upload.change(function() {\n\t\t_ELEMENTS.input_fake_file_name.val(this.value)\n\t})\n\n\t_ELEMENTS.button_fake_file_browse.click(function() {\n\t\t_ELEMENTS.input_fake_file_upload.trigger('click')\n\t})\n\n\t// Update image description\n\t_ELEMENTS.table_images.on('click', '[data-update-route]', function() {\n\t\tvar description = jQuery(this).closest('tr').find('textarea').val()\n\n\t\tjQuery.post(this.getAttribute('data-update-route'), {description: description})\n\t})\n\n\t// Delete image\n\t_ELEMENTS.table_images.on('click', '[data-delete-route]', function() {\n\t\tvar that = this\n\n\t\tjQuery.getJSON(this.getAttribute('data-delete-route'), function() {\n\t\t\tjQuery(that).closest('tr').remove()\n\t\t})\n\t})\n\n\t// Image upload\n\t_ELEMENTS.button_add_new_image.click(function() {\n\t\tvar form_data = new FormData()\n\n\t\tform_data.append('file', _ELEMENTS.input_fake_file_upload[0].files[0])\n\t\tform_data.append('watermark', true)\n\t\tform_data.append('description', _ELEMENTS.textarea_image_description.val())\n\n\t\tjQuery.ajax({\n\t\t\turl   : this.getAttribute('data-route'),\n\t\t\tdata  : form_data,\n\t\t\ttype  : 'POST',\n\t\t\tcache : false,\n\t\t\tcontentType : false,\n\t\t\tprocessData : false,\n\t\t\tsuccess: function(response) {\n\t\t\t\tvar tr = jQuery('<tr/>').attr('data-image-id', response.id).appendTo(_ELEMENTS.table_images.find('tbody'))\n\n\t\t\t\tvar img = jQuery('<img/>').attr({\n\t\t\t\t\twidth: 140,\n\t\t\t\t\theight: 140,\n\t\t\t\t\tsrc: response.get_url,\n\t\t\t\t\tclass: 'img-thumbnail'\n\t\t\t\t})\n\n\t\t\t\tjQuery('<a/>').attr('href', response.get_url).append(img).appendTo(tr).wrap(jQuery('<td/>').addClass('text-center'))\n\n\t\t\t\tjQuery('<textarea/>').attr({\n\t\t\t\t\tclass: 'form-control',\n\t\t\t\t\trows: 3,\n\t\t\t\t\tcols: 30\n\t\t\t\t}).text(response.description).appendTo(tr).wrap(jQuery('<td/>'))\n\n\t\t\t\tvar td = jQuery('<td/>').appendTo(tr)\n\n\t\t\t\tjQuery('<button/>').attr({\n\t\t\t\t\tclass: 'btn btn-default btn-sm',\n\t\t\t\t\t'data-update-route': response.upd_url\n\t\t\t\t}).text('Update').appendTo(td)\n\n\t\t\t\ttd.append(' ')\n\n\t\t\t\tjQuery('<button/>').attr({\n\t\t\t\t\tclass: 'btn btn-default btn-sm',\n\t\t\t\t\t'data-delete-route': response.del_url\n\t\t\t\t}).text('Delete').appendTo(td)\n\n\t\t\t\t_ELEMENTS.div_add_image_modal_container.modal('hide')\n\n\t\t\t\tif (typeof image_attach_route !== 'undefined') {\n\t\t\t\t\tvar url = image_attach_route + '/' + response.id\n\n\t\t\t\t\tjQuery.post(image_attach_route, {image_id: response.id})\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t})\n\n\t// Work save\n\t_ELEMENTS.button_save_work.click(function() {\n\t\t_ELEMENTS.button_save_work.button('loading')\n\n\t\tvar data = {}\n\n\t\tjQuery('.container').find('[name]').each(function() {\n\t\t\tdata[this.name] = this.value\n\t\t})\n\n\t\tdata.images = _ELEMENTS.table_images.find('tr[data-image-id]').map(function() {return this.getAttribute('data-image-id')}).get()\n\n\t\tjQuery.post(this.getAttribute('data-save-route'), data, function(response) {\n\t\t\tif (response.redirect_to) {\n\t\t\t\twindow.location = response.redirect_to\n\t\t\t}\n\t\t}).complete(function() {\n\t\t\t_ELEMENTS.button_save_work.button('reset')\n\t\t})\n\t})\n})"],"sourceRoot":"/source/"}